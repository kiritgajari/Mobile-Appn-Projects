(window.webpackJsonp=window.webpackJsonp||[]).push([[22,37,71,84],{34:function(e,o,t){"use strict";t.r(o);t(1),t(7);function r(e,o,t,r){e.supportsStatistics=!0,e.settings={statistics:!1},e.getSettings=function(){e.loader=!0,r.getStatistics().then(function(o){e.settings.statistics="true"===o.data,e.supportsStatistics=!0},function(t){if(404===t.status)e.supportsStatistics=!1;else{const e=getError(t.data);o.error(e,"Error getting settings")}})},e.getSettings(),e.setSettings=function(){e.loader=!0,r.toggleStatistics(e.settings.statistics).then(function(){t.close(),o.success("Settings have been saved")},function(e){const t=getError(e.data);o.error(t,"Error saving settings")})},e.submitForm=function(){e.setSettings()},e.cancel=function(){t.dismiss("cancel")}}function i(e,o,t,r){e.loader=!0,o.checkLicenseHardcoded().success(function(e){r.isLicenseHardcoded="true"===e}).error(function(){r.isLicenseHardcoded=!1,t.error("Error checking license availability")}).then(function(){o.getLicenseInfo().success(function(o){e.loader=!1,e.license=o}).error(function(){e.loader=!1,e.license={message:"No license was set.",valid:!1}})})}function n(e,o,t,r,i,n,s){e.$on("securityInit",function(){s.isAdmin()||t.path("/license")}),e.sendLicenseToValidateAndActivate=c;const a=$(".license-textarea");function c(e){o.sendLicenseToValidate(e).success(function(t){"Invalid"!==t.licensee?(a.val(e),function(e,t){r.open({templateUrl:"js/angular/settings/modal/validate-license.html",controller:"ValidateLicenseModalCtrl",resolve:{license:function(){return e}}}).result.then(function(){!function(e){e||(e=a.val());if(e){const t=atob(e.replace(/\s/g,""));o.registerLicense(t).success(function(){n.history.back()}).error(function(){i.error("Error registering GraphDB license")})}else i.error("No license code available in textarea")}(t)})}(t,e)):(a.val(""),i.error(t.message))}).error(function(){i.error("Invalid license")})}e.$watch("currentFile",function(){if(e.currentFile){const t=e.currentFile;o.extractFromLicenseFile(t).success(function(e){c(e)}).error(function(){i.error("Could not upload file")})}}),e.getBackToPreviousPage=function(){n.history.back()}}function s(e,o,t){e.ok=function(){o.close()},e.cancel=function(){o.dismiss("cancel")},e.license=t}function a(e){e.loader=!0,e.setLoader=function(o){e.loader=o}}angular.module("graphdb.framework.settings.controllers",["ngCookies","ui.bootstrap","graphdb.framework.core.services.jwtauth","toastr"]).controller("ActiveLocationSettingsCtrl",r).controller("ValidateLicenseModalCtrl",s).controller("LicenseCtrl",i).controller("RegisterLicenseCtrl",n).controller("LoaderSamplesCtrl",a),r.$inject=["$scope","toastr","$modalInstance","LicenseRestService"],i.$inject=["$scope","LicenseRestService","toastr","$rootScope"],n.$inject=["$scope","LicenseRestService","$location","$modal","toastr","$window","$jwtAuth"],s.$inject=["$scope","$modalInstance","license"],a.$inject=["$scope"]},64:function(e,o){const t=new RegExp("^[a-zA-Z0-9-_]+$"),r=new RegExp("[0-9]"),i=[{id:"empty",name:"No inference"},{id:"rdfs",name:"RDFS"},{id:"owl-horst",name:"OWL-Horst"},{id:"owl-max",name:"OWL-Max"},{id:"owl2-ql",name:"OWL2-QL"},{id:"owl2-rl",name:"OWL2-RL"},{id:"rdfs-optimized",name:"RDFS (Optimized)"},{id:"rdfsplus-optimized",name:"RDFS-Plus (Optimized)"},{id:"owl-horst-optimized",name:"OWL-Horst (Optimized)"},{id:"owl-max-optimized",name:"OWL-Max (Optimized)"},{id:"owl2-ql-optimized",name:"OWL2-QL (Optimized)"},{id:"owl2-rl-optimized",name:"OWL2-RL (Optimized)"}];function n(e,o,t,r,i,n,s){e.loader=!0,e.isLocationInactive=function(o){return!o.active||!e.hasActiveLocation()},e.getLocations=function(){return r.getLocations()},e.hasActiveLocation=function(){return r.hasActiveLocation()},e.getActiveLocation=function(){return r.getActiveLocation()},e.getDegradedReason=function(){return r.getDegradedReason()},e.getRepositories=function(){return r.getRepositories()},e.deleteLocation=function(o){i.openSimpleModal({title:"Confirm detach",message:"Are you sure you want to detach the location '"+o+"'?",warning:!0}).result.then(function(){e.loader=!0,r.deleteLocation(o)})},e.addLocationHttp=function(o){e.loader=!0,s.addLocation(o).success(function(o){e.locations=o,r.init()}).error(function(o){const r=getError(o);t.error(r,"Error"),e.loader=!1})},e.addLocation=function(){o.open({templateUrl:"js/angular/templates/modal/add-location.html",windowClass:"addLocationDialog",controller:"AddLocationCtrl"}).result.then(function(o){e.addLocationHttp(o)})},e.addRepositoryFile=function(){o.open({templateUrl:"js/angular/templates/modal/add-repository-file.html",controller:"AddRepositoryFileCtrl"})},e.editLocationHttp=function(o){e.loader=!0,s.editLocation(o).success(function(o){e.locations=o,r.init()}).error(function(o){const r=getError(o);t.error(r,"Error"),e.loader=!1})},e.editLocation=function(t){o.open({templateUrl:"js/angular/templates/modal/edit-location.html",controller:"EditLocationCtrl",resolve:{location:function(){return t}}}).result.then(function(o){e.editLocationHttp(o)},function(){})},e.activateLocationRequest=function(o){e.loader=!0;const i={uri:o.uri};s.enableLocation(i).success(function(){r.setRepository(""),r.init()}).error(function(e){const r=getError(e);t.error(r,"Error"),document.getElementById("switch-"+o.$$hashKey).checked=!1})},e.activateLocation=function(o){e.hasActiveLocation()?i.openSimpleModal({title:"Confirm location change",message:"Are you sure you want to change the location?",warning:!0}).result.then(function(){e.activateLocationRequest(o)},function(){document.getElementById("switch-"+o.$$hashKey).checked=!1}):e.activateLocationRequest(o)},e.setRepository=function(e){r.setRepository(e)},e.deleteRepository=function(o){i.openSimpleModal({title:"Confirm delete",message:"Are you sure you want to delete the repository '"+o+"'?<p>All data in the repository will be lost.</p>",warning:!0}).result.then(function(){e.loader=!0,r.deleteRepository(o)})},e.toggleDefaultRepository=function(o){e.getDefaultRepository()===o?r.setDefaultRepository(null):r.setDefaultRepository(o)},e.getDefaultRepository=function(){return r.getDefaultRepository()},e.getRepositoryDownloadLink=function(e){let o="rest/repositories/"+e.id+"/download";const t=n.getAuthToken();return t&&(o=o+"?authToken="+encodeURIComponent(t)),o},e.copyToClipboard=function(e){i.openCopyToClipboardModal(e)},e.fromFile=function(){o.open({templateUrl:"js/angular/templates/modal/upload-repository-config.html",controller:"UploadRepositoryConfigCtrl"}).result.then(function(){r.init()})},e.openActiveLocationSettings=function(){o.open({templateUrl:"js/angular/settings/modal/location-settings.html",controller:"ActiveLocationSettingsCtrl"})},r.init()}function s(e,o,t,r){e.upload=function(o){o&&o.length&&(e.uploadFile=o[0])},e.ok=function(){e.uploadFile&&(e.uploadFileLoader=!0,t.upload({url:"rest/repositories",method:"POST",data:{config:e.uploadFile}}).success(function(){e.uploadFileLoader=!1,o.close()}).error(function(o){const t=getError(o);r.error(t,"Error"),e.uploadFileLoader=!1}))},e.cancel=function(){o.dismiss("cancel")}}function a(e,o){e.advanced=!1,e.newLocation={uri:"",username:"",password:"",active:!1},e.switchAdvanced=function(){e.advanced=!e.advanced},e.isValidLocation=function(){return(e.newLocation.uri.length<6||0===e.newLocation.uri.indexOf("http:")||0===e.newLocation.uri.indexOf("https:"))&&e.newLocation.uri.indexOf("/repositories")<=-1},e.ok=function(){o.close(e.newLocation)},e.cancel=function(){o.dismiss("cancel")}}function c(e,o,t){e.editedLocation=angular.copy(t),e.ok=function(){o.close(e.editedLocation)},e.cancel=function(){o.dismiss("cancel")}}function l(e,o,n,s,a,c,l,u,d){e.rulesets=i.slice(),e.loader=!0,e.pageTitle="Create Repository",e.repositoryInfo={id:"",params:{},title:"",type:""},e.hasActiveLocation=function(){return n.hasActiveLocation()},e.activeLocation=function(){return n.getActiveLocation()};let p=!1;e.upload=function(t){t&&t.length&&(e.uploadFile=t[0],e.uploadFileLoader=!0,a.upload({url:"rest/repositories/uploadRuleSet",data:{ruleset:e.uploadFile}}).progress(function(e){}).success(function(t){if(t.success){const o=e.uploadFile.name,r={id:t.fileLocation,name:"Custom: "+o};e.rulesetPie?e.rulesets[0]=r:e.rulesets.unshift(r),e.rulesetPie=t.fileLocation,e.rulesetPieFile=o,e.repositoryInfo.params.ruleset.value=e.rulesetPie}else o.error(t.errorMessage),p=!0;e.uploadFileLoader=!1}).error(function(t){const r=getError(t);o.error(r,"Error"),e.uploadFile="",e.uploadFileLoader=!1}))},e.isEnterprise=c,e.isFreeEdition=l,e.getConfig=function(t){d.getRepositoryConfiguration(t).success(function(o){e.repositoryInfo.params=o.params,e.repositoryInfo.type=o.type,e.loader=!1}).error(function(t){const r=getError(t);o.error(r,"Error"),e.loader=!1})},e.isEnterprise?e.getConfig("worker"):e.isFreeEdition?e.getConfig("free"):e.getConfig("se"),e.formError=function(){o.error("There is an error in the form!")},e.goBackToPreviousLocation=function(){angular.isDefined(u.previous)?(delete s.$$search.previous,s.path("/")):s.path("/repository")},e.createRepoHttp=function(){e.loader=!0,d.createRepository(e.repositoryInfo).success(function(){o.success("The repository "+e.repositoryInfo.id+" has been created."),n.init(e.goBackToPreviousLocation)}).error(function(t){const r=getError(t);o.error(r,"Error"),e.loader=!1})},e.createRepo=function(){if(!e.repositoryInfo.id)return void o.error("Repository id cannot be empty");e.isInvalidRepoName=!t.test(e.repositoryInfo.id);const i=e.repositoryInfo.params;i.entityIndexSize&&i.queryLimitResults&&i.queryTimeout&&(e.isInvalidEntityIndexSize=!r.test(e.repositoryInfo.params.entityIndexSize.value),e.isInvalidQueryTimeout=!r.test(e.repositoryInfo.params.queryTimeout.value),e.isInvalidQueryLimit=!r.test(e.repositoryInfo.params.queryLimitResults.value)),p?o.error("Invalid rule-set file. Please upload a valid one."):e.isInvalidRepoName||e.isInvalidEntityIndexSize||e.isInvalidQueryLimit||e.isInvalidQueryLimit?e.formError():e.createRepoHttp()},e.rulesetWarning=function(){const o=e.repositoryInfo.params;return void 0===o||void 0===o.ruleset||void 0===o.disableSameAs?"":0===o.ruleset.value.indexOf("owl")&&"true"===o.disableSameAs.value?"Disabling owl:sameAs for this ruleset may cause incomplete inference with owl:sameAs statements.":0===o.ruleset.value.indexOf("rdfs")&&"false"===o.disableSameAs.value?"This ruleset does not need owl:sameAs, consider disabling it.":o.ruleset.value===e.rulesetPie?"This custom ruleset may or may not depend on owl:sameAs.":""}}function u(e,o,n,s,a,c,l,u,d){e.rulesets=i.slice(),e.editRepoPage=!0,e.canEditRepoId=!1,e.params=o,e.loader=!0,e.isEnterprise=l,e.isFreeEdition=u,e.repositoryInfo={},e.repositoryInfo.id=e.params.repositoryId,e.saveRepoId=e.params.repositoryId,e.pageTitle="Edit Repository: "+e.params.repositoryId,e.hasActiveLocation=function(){return s.hasActiveLocation()},e.$watch(e.hasActiveLocation,function(){e.hasActiveLocation&&d.getRepository(e.repositoryInfo.id).success(function(o){if(angular.isDefined(o.params.ruleset)){let t=!1;if(angular.forEach(e.rulesets,function(e){e.id===o.params.ruleset.value&&(t=!0)}),o.params.ruleset&&t){let t=o.params.ruleset.value.lastIndexOf("/");-1===t&&(t=o.params.ruleset.value.lastIndexOf("\\"));let r=o.params.ruleset.value;-1!==t&&(r=r.substring(t+1)),e.rulesets.unshift({id:o.params.ruleset.value,name:"Custom: "+r})}}e.repositoryInfo=o,e.repositoryInfo.saveId=e.saveRepoId,e.loader=!1}).error(function(t,r){if(404===r&&"system"!==o.repositoryId)n.error("Repo with name <b>"+o.repositoryId+"</b> doesn't exists","Error",{allowHtml:!0}),e.loader=!1,a.path("repository");else if(404===r&&"system"===o.repositoryId)n.error("<b>System</b> repository can't be edited","Error",{allowHtml:!0}),e.loader=!1,a.path("repository");else{const o=getError(t);n.error(o,"Error"),e.loader=!1}})}),e.formError=function(){n.error("There is an error in the form!")},e.editRepoHttp=function(){e.loader=!0,d.editRepository(e.repositoryInfo.saveId,e.repositoryInfo).success(function(){n.success("The repository "+e.repositoryInfo.saveId+" has been edited."),s.init(e.goBackToPreviousLocation)}).error(function(o){const t=getError(o);n.error(t,"Error"),e.loader=!1})},e.editRepository=function(){e.isInvalidRepoName=!t.test(e.repositoryInfo.id),e.isInvalidEntityIndexSize=!r.test(e.repositoryInfo.params.entityIndexSize.value),e.isInvalidQueryTimeout=!r.test(e.repositoryInfo.params.queryTimeout.value),e.isInvalidQueryLimit=!r.test(e.repositoryInfo.params.queryLimitResults.value),e.isInvalidRepoName?e.formError():c.openSimpleModal({title:"Confirm edit",message:e.repositoryInfo.saveId!==e.repositoryInfo.id?" You are changing the repository id. Are you sure?":'Save changes to this repository?<br><br><span class="icon-warning" style="color: #d54a33"> Restart of GraphDB needed!</span>',warning:!0}).result.then(function(){e.editRepoHttp()})},e.editRepositoryId=function(){let o="Changing the repository id is a dangerous operation since it moves the repository folder. Also, it may be slow due to reinitialisation of the repository.";e.isEnterprise&&(o+="If your repository is in a cluster, it is your responsibility to update the cluster after renaming."),c.openSimpleModal({title:"Confirm enable edit",message:o+" Are you sure you want to enable repository id editing?",warning:!0}).result.then(function(){e.canEditRepoId=!0})},e.goBackToPreviousLocation=function(){angular.isDefined(o.previous)?(delete a.$$search.previous,a.path("/")):a.path("/repository")}}angular.module("graphdb.framework.repositories.controllers",["ngCookies","ui.bootstrap","graphdb.framework.core.services.repositories","toastr","ngFileUpload"]).controller("LocationsAndRepositoriesCtrl",n).controller("AddLocationCtrl",a).controller("EditLocationCtrl",c).controller("AddRepositoryCtrl",l).controller("EditRepositoryCtrl",u).controller("UploadRepositoryConfigCtrl",s),n.$inject=["$scope","$modal","toastr","$repositories","ModalService","$jwtAuth","LocationsRestService"],s.$inject=["$scope","$modalInstance","Upload","toastr"],a.$inject=["$scope","$modalInstance"],c.$inject=["$scope","$modalInstance","location"],l.$inject=["$scope","toastr","$repositories","$location","Upload","isEnterprise","isFreeEdition","$routeParams","RepositoriesRestService"],u.$inject=["$scope","$routeParams","toastr","$repositories","$location","ModalService","isEnterprise","isFreeEdition","RepositoriesRestService"]},65:function(e,o,t){"use strict";t.r(o);t(1),t(6),t(3),t(34),t(15),t(7),t(21),t(22);function r(e){e.interceptors.push("$unauthorizedInterceptor")}function i(e,o){e.$on("$locationChangeStart",function(){e.isLicenseHardcoded&&"/license/register"===o.url()&&o.path("license")})}angular.module("graphdb.framework.settings",["toastr","ui.bootstrap","graphdb.framework.rest.license.service","graphdb.framework.settings.controllers","graphdb.framework.core.interceptors.unauthorized","graphdb.framework.core.services.jwtauth"]).config(r).run(i),r.$inject=["$httpProvider","$routeProvider"],i.$inject=["$rootScope","$location"]},96:function(e,o,t){"use strict";t.r(o);t(1),t(6),t(9),t(64),t(8),t(65),t(21),t(22);angular.module("graphdb.framework.repositories",["ui.bootstrap","toastr","ngCookies","ngRoute","graphdb.framework.repositories.controllers","graphdb.framework.core.services.repositories","graphdb.framework.core.directives","graphdb.framework.core.controllers","graphdb.framework.settings"])}}]);
//# sourceMappingURL=22.77be9a0b99675d0aec11.bundle.js.map